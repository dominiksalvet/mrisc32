% -*- mode: latex; tab-width: 2; indent-tabs-mode: nil; -*-
%------------------------------------------------------------------------------
% MRISC32 ISA Manual - Preface.
%
% This work is licensed under the Creative Commons Attribution-ShareAlike 4.0
% International License. To view a copy of this license, visit
% http://creativecommons.org/licenses/by-sa/4.0/ or send a letter to
% Creative Commons, PO Box 1866, Mountain View, CA 94042, USA.
%------------------------------------------------------------------------------

\chapter{Instructions}

\todo{We need to auto-generate these sections from some database.}

\section{Load and store}

\tbd

\section{Branch}

\tbd

\section{Integer arithmetic}

\subsection{ADD}

Compute the sum of two integer operands.

\begin{lstlisting}[style=assembler]
1: ADD Rt, Ra, Rb
2: ADD Rt, Ra, #value
\end{lstlisting}

\begin{bytefield}{32}
  \bitheader{0,7,9,14,15,16,21,26,31} \\
  \begin{rightwordgroup}{1}
    \bitboxes*{1}{000000} &
    \bitbox{5}{Rt} &
    \bitbox{5}{Ra} &
    \bitbox{2}{V} &
    \bitbox{5}{Rb} &
    \bitbox{2}{T} &
    \bitboxes*{1}{0010101}
  \end{rightwordgroup} \\
  \begin{rightwordgroup}{2}
    \bitboxes*{1}{010101} &
    \bitbox{5}{Rt} &
    \bitbox{5}{Ra} &
    \bitbox{1}{V} &
    \bitbox{1}{H} &
    \bitbox{14}{IM}
  \end{rightwordgroup}
\end{bytefield}

\begin{lstlisting}[style=pseudocode]
1: Rt = Ra + Rb
2: Rt = Ra + ext14(H,IM)
\end{lstlisting}

\subsection{SUB}

Compute the difference of two integer operands.

\begin{lstlisting}[style=assembler]
1: SUB Rt, Rb, Ra
2: SUB Rt, #value, Ra
\end{lstlisting}

\begin{bytefield}{32}
  \bitheader{0,7,9,14,15,16,21,26,31} \\
  \begin{rightwordgroup}{1}
    \bitboxes*{1}{000000} &
    \bitbox{5}{Rt} &
    \bitbox{5}{Ra} &
    \bitbox{2}{V} &
    \bitbox{5}{Rb} &
    \bitbox{2}{T} &
    \bitboxes*{1}{0010110}
  \end{rightwordgroup} \\
  \begin{rightwordgroup}{2}
    \bitboxes*{1}{010110} &
    \bitbox{5}{Rt} &
    \bitbox{5}{Ra} &
    \bitbox{1}{V} &
    \bitbox{1}{H} &
    \bitbox{14}{IM}
  \end{rightwordgroup}
\end{bytefield}

\begin{lstlisting}[style=pseudocode]
1: Rt = Rb - Ra
2: Rt = ext14(H,IM) - Ra
\end{lstlisting}

\todo{Add missing integer arithmetic instructions.}

\section{Logic}

\tbd

\section{Saturating and halving}

\tbd

\section{Floating-point}

\subsection{FADD}

Compute the sum of two floating-point operands.

\begin{lstlisting}[style=assembler]
FADD Rt, Ra, Rb
\end{lstlisting}

\begin{bytefield}{32}
  \bitheader{0,7,9,14,16,21,26,31} \\
  \bitboxes*{1}{000000} &
  \bitbox{5}{Rt} &
  \bitbox{5}{Ra} &
  \bitbox{2}{V} &
  \bitbox{5}{Rb} &
  \bitbox{2}{T} &
  \bitboxes*{1}{1110000}
\end{bytefield}

\begin{lstlisting}[style=pseudocode]
Rt = Ra + Rb
\end{lstlisting}

\subsection{FSUB}

Compute the difference of two floating-point operands.

\begin{lstlisting}[style=assembler]
FSUB Rt, Ra, Rb
\end{lstlisting}

\begin{bytefield}{32}
  \bitheader{0,7,9,14,16,21,26,31} \\
  \bitboxes*{1}{000000} &
  \bitbox{5}{Rt} &
  \bitbox{5}{Ra} &
  \bitbox{2}{V} &
  \bitbox{5}{Rb} &
  \bitbox{2}{T} &
  \bitboxes*{1}{1110001}
\end{bytefield}

\begin{lstlisting}[style=pseudocode]
Rt = Ra - Rb
\end{lstlisting}

\todo{Add missing floating-point instructions.}

\section{Pseudo instructions}

\tbd
